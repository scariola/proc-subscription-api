<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core"
	xmlns="http://www.mulesoft.org/schema/mule/core"
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd">
	<sub-flow name="common-error-processing-subflow"
		doc:id="b2162486-934c-449e-b657-f53de081f72b">
		<logger level="INFO"
			doc:name="START - Common Error  Processing"
			doc:id="3540012f-b031-4564-8890-5a34e2150563"
			message="START - Common Error  Processing " />
		<flow-ref doc:name="impl-subscription-put-audit-subflow"
			doc:id="03f00fdd-d99b-46c7-adf1-9dd7659d22a3"
			name="impl-subscription-put-audit-subflow" />
		<flow-ref doc:name="impl-subscription-post-sms-subflow"
			doc:id="a9d3eb95-0d1c-433b-8361-eb02b2b68eac"
			name="impl-subscription-post-sms-subflow" />
		<logger level="INFO" doc:name="END - Common Error  Processing "
			doc:id="75a9cf47-b2e5-4353-8e74-c674e73f8c8b"
			message="END - Common Error  Processing " />
	</sub-flow>
	<error-handler
		name="proc-subscription-api-Shared_Error_Handler"
		doc:id="ce502ca3-fef7-49aa-b16a-0eafa6daa05f">
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="8300b75d-3a63-4da3-b29d-3c189866a6b7" type="INPUT:INELIGIBLE">
			<flow-ref doc:name="common-error-processing-subflow" doc:id="1884284e-678f-48a9-82b9-cb97dd2fa726" name="common-error-processing-subflow" />
			<ee:transform doc:name="Construct failure Subscription Result Payload , var-httpStatus" doc:id="c08db1e2-049e-484b-911c-a6d6902c8ec4">
				<ee:message>
					<ee:set-payload resource="dw/api-response-failure-200.dwl" />
				</ee:message>
				<ee:variables>
					<ee:set-variable resource="dw/var-httpStatus-200.dwl" variableName="httpStatus" />
				</ee:variables>
			</ee:transform>
		</on-error-propagate>
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="cd91cd77-93e7-45e1-811f-a9ef071e7ffa" type="INPUT:REQUEST_CONFLICT">
			<flow-ref doc:name="common-error-processing-subflow" doc:id="a4f3cb81-17b8-4f11-abba-c5a040915c05" name="common-error-processing-subflow" />
			<ee:transform doc:name="Construct failure Subscription Result Payload , var-httpStatus" doc:id="b8edee11-aab1-499e-be89-5c1c7d17de6e">
				<ee:message>
					<ee:set-payload resource="dw/api-response-success-200.dwl" />
				</ee:message>
				<ee:variables>
					<ee:set-variable resource="dw/var-httpStatus-200.dwl" variableName="httpStatus" />
				</ee:variables>
			</ee:transform>
		</on-error-propagate>
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="18bb70e4-7b76-476d-8352-e4fca8adf8ee" type="INPUT:UNSUPPORTED">
			<flow-ref doc:name="common-error-processing-subflow" doc:id="0b3634df-898d-40eb-b3c9-8709a47e518e" name="common-error-processing-subflow" />
			<ee:transform doc:name="Construct failure Subscription Result Payload , var-httpStatus" doc:id="3cadf184-2899-4313-81f9-93f634e52eb8">
				<ee:message>
					<ee:set-payload resource="dw/api-response-failure-200.dwl" />
				</ee:message>
				<ee:variables>
					<ee:set-variable resource="dw/var-httpStatus-200.dwl" variableName="httpStatus" />
				</ee:variables>
			</ee:transform>
		</on-error-propagate>
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="323826ea-36f5-4407-89c2-30ae799912d7" type="INPUT:INVALID_KEYWORD">
				<flow-ref doc:name="common-error-processing-subflow" doc:id="e206025d-03f7-4628-a4af-42bc57a3379e" name="common-error-processing-subflow" />
			<ee:transform doc:name="Construct failure Subscription Result Payload , var-httpStatus" doc:id="539bb880-d841-487b-b352-fc5d3569a503" >
				<ee:message >
					<ee:set-payload resource="dw/api-response-failure-200.dwl" />
				</ee:message>
				<ee:variables >
					<ee:set-variable resource="dw/var-httpStatus-400.dwl" variableName="httpStatus" />
				</ee:variables>
			</ee:transform>
			</on-error-propagate>
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="31c28ae5-0b29-4149-816e-adb539aea003" type="HTTP:BAD_REQUEST">
			<flow-ref doc:name="common-error-processing-subflow" doc:id="0b8631e6-fdb7-4275-910d-93ebbf5a271d" name="common-error-processing-subflow" />
			<ee:transform doc:name="Set Payload - http bad request,var-httpStatus" doc:id="dab8d964-a2e7-4415-9cde-71266c365368">
				<ee:message>
					<ee:set-payload resource="dw/payload-http-bad-request-response.dwl" />
				</ee:message>
				<ee:variables>
					<ee:set-variable resource="dw/var-httpStatus-400.dwl" variableName="httpStatus" />
				</ee:variables>
			</ee:transform>
		</on-error-propagate>
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="90a4686e-0e9f-46de-9887-2d1cbcbadf43" type="HTTP:CONNECTIVITY">
			<flow-ref doc:name="common-error-processing-subflow" doc:id="f1b5928a-e753-4dad-9857-c9f7a40c4b1b" name="common-error-processing-subflow" />
			<ee:transform doc:name="Set Payload - http connectivity,var-httpStatus" doc:id="e8ff00c8-4af6-4c14-b95e-c654505cb6b5">
				<ee:message>
					<ee:set-payload resource="dw/payload-http-connectiviry-response.dwl" />
				</ee:message>
				<ee:variables>
					<ee:set-variable resource="dw/var-httpStatus-503.dwl" variableName="httpStatus" />
				</ee:variables>
			</ee:transform>
		</on-error-propagate>
		<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="b2797cb4-29c7-45ad-be4d-60ecd3727179" type="ANY">
			<flow-ref doc:name="common-error-processing-subflow" doc:id="aeb0f069-204b-450e-bee1-193752d3d568" name="common-error-processing-subflow" />
			<ee:transform doc:name="Set Payload - any, var-httpStatus" doc:id="b1a08c09-06a0-455a-91d9-c9fb3c0f94b0">
				<ee:message>
					<ee:set-payload resource="dw/payload-http-any-response.dwl" />
				</ee:message>
				<ee:variables>
					<ee:set-variable resource="dw/var-httpStatus-500.dwl" variableName="httpStatus" />
				</ee:variables>
			</ee:transform>
		</on-error-propagate>
	</error-handler>


	<error-handler
		name="proc-subscription-api_APIKIT_Error_Handler">

		<on-error-propagate type="APIKIT:BAD_REQUEST">
			<ee:transform
				doc:name="Set Payload - Bad Request, var-httpStatus">
				<ee:message>
					<ee:set-payload resource="dw/api-bad-request.dwl" />
				</ee:message>
				<ee:variables>
					<ee:set-variable
						resource="dw/var-httpStatus-400.dwl" variableName="httpStatus" />
				</ee:variables>
			</ee:transform>
		</on-error-propagate>

		<on-error-propagate type="APIKIT:NOT_FOUND">
			<ee:transform
				doc:name="Set Payload - Not Found, var-httpStatus">
				<ee:message>
					<ee:set-payload resource="dw/api-not-found.dwl" />
				</ee:message>
				<ee:variables>
					<ee:set-variable
						resource="dw/var-httpStatus-404.dwl" variableName="httpStatus" />
				</ee:variables>
			</ee:transform>
		</on-error-propagate>

		<on-error-propagate
			type="APIKIT:METHOD_NOT_ALLOWED">
			<ee:transform
				doc:name="Set Payload - Method Not Allowed, var-httpStatus">
				<ee:message>
					<ee:set-payload
						resource="dw/api-method-not-allowed.dwl" />
				</ee:message>
				<ee:variables>
					<ee:set-variable
						resource="dw/var-httpStatus-405.dwl" variableName="httpStatus" />
				</ee:variables>
			</ee:transform>
		</on-error-propagate>

		<on-error-propagate type="APIKIT:NOT_ACCEPTABLE">
			<ee:transform doc:name="Set  Payload - Not Acceptable">
				<ee:message>
					<ee:set-payload resource="dw/api-not-acceptable.dwl" />
				</ee:message>
				<ee:variables>
					<ee:set-variable
						resource="dw/var-httpStatus-406.dwl" variableName="httpStatus" />
				</ee:variables>
			</ee:transform>
		</on-error-propagate>

		<on-error-propagate
			type="APIKIT:UNSUPPORTED_MEDIA_TYPE">
			<ee:transform
				doc:name="Set Payload - Unsupported Media Type, var-httpStatus">
				<ee:message>
					<ee:set-payload
						resource="dw/api-unsupported-media-type.dwl" />
				</ee:message>
				<ee:variables>
					<ee:set-variable
						resource="dw/var-httpStatus-415.dwl" variableName="httpStatus" />
				</ee:variables>
			</ee:transform>
		</on-error-propagate>

		<on-error-propagate type="APIKIT:NOT_IMPLEMENTED">
			<ee:transform doc:name="Set Payload - Not Implemented, var-httpStatus">
				<ee:message>
					<ee:set-payload
						resource="dw/api-not-implemented.dwl" />
				</ee:message>
				<ee:variables>
					<ee:set-variable
						resource="dw/var-httpStatus-501.dwl" variableName="httpStatus" />
				</ee:variables>
			</ee:transform>
		</on-error-propagate>

	</error-handler>
</mule>
